
<script>

// variáveis
var calculo_c5_R = 8.314462618 // em J/mol*K
var calculo_c6_F = 96485.33 // em C/mol
var calculo_c7_T = 25 // em °C

var calculo_c11_kPhMaior = 2
var calculo_c15_kPhMenor = 2

function desvpada(matriz){ // método n-1
    
    // calcular a média
    var somaElementos = 0;

    for (var m = 0; m < matriz.length; m++){
      somaElementos += matriz[m];
    }
 	 var media = somaElementos / (matriz.length-0) // aqui é a média normal
    

    // subtrair a média de cada um dos valores
    // salvar cada resultado individual e
    // elevar ao quadrado cada resultado

    var difMedia = []
    for (var m = 0; m < matriz.length; m++){
        difMedia.push((matriz[m]-media)*(matriz[m]-media));
    }

    // calcular a média das diferenças que foram elevadas ao quadrado
    var somaDifMedia = 0;
    for (var d = 0; d < difMedia.length; d++){
        somaDifMedia += difMedia[d];
    } 
  
    var mediaDiferencas = somaDifMedia / (difMedia.length-1); // aqui é o n-1

    // tirar a raiz quadrada
    return Math.sqrt(mediaDiferencas);
}



function m2p()
{

    //  pH maior
        var phMaior = document.getElementById('metodo2pontos_i8').value;
        
        var eMaior = (
        document.getElementById('metodo2pontos_i14').value +
        document.getElementById('metodo2pontos_i15').value +
        document.getElementById('metodo2pontos_i16').value
        )/3;

        var uPhMaior = document.getElementById('metodo2pontos_i9').value;


    // pH Menor
        var phMenor = document.getElementById('metodo2pontos_i11').value;
        
        var eMenor = (
        document.getElementById('metodo2pontos_i18').value +
        document.getElementById('metodo2pontos_i19').value +
        document.getElementById('metodo2pontos_i20').value
        )/3;
        
        var uPhMenor = document.getElementById('metodo2pontos_i12').value;


    // E(x)
        var eX = (
        document.getElementById('metodo2pontos_i22').value +
        document.getElementById('metodo2pontos_i23').value +
        document.getElementById('metodo2pontos_i24').value
        )/3;

        var kLinha = (eMaior - eMenor)/(phMaior - phMenor);

        var pHx = phMaior - (eMaior - eX)/kLinha;

    ////////////////////////////////////////////////////////////////
    // Incerteza k'

    // variabilidade E (maior)
    var leituras_eMaior = [
        document.getElementById('metodo2pontos_i14').value,
        document.getElementById('metodo2pontos_i15').value,
        document.getElementById('metodo2pontos_i16').value
    ];
    var variabilidade_eMaior_uxi = desvpada(leituras_eMaior);
    var variabilidade_eMaior_div = Math.sqrt(4);
    var variabilidade_eMaior_coef = Math.abs( 1/(phMaior-phMenor) );
    var variabilidade_eMaior_ciUxi = variabilidade_eMaior_uxi * variabilidade_eMaior_coef/variabilidade_eMaior_div;
    var variabilidade_eMaior_uiY2 = variabilidade_eMaior_ciUxi^2;

    // resolução E (maior)
    var resolucao_eMaior_uxi = document.getElementById('configuracoes_e5').value/2;
    var resolucao_eMaior_div = Math.sqrt(3);
    var resolucao_eMaior_coef = variabilidade_eMaior_coef;
    var resolucao_eMaior_ciUxi = resolucao_eMaior_uxi * resolucao_eMaior_coef/resolucao_eMaior_div;
    var resolucao_eMaior_uiY2 = resolucao_eMaior_ciUxi^2;


    // variabilidade E (menor)
    var leituras_eMenor = [
        document.getElementById('metodo2pontos_i18').value,
        document.getElementById('metodo2pontos_i19').value,
        document.getElementById('metodo2pontos_i20').value
    ];
    var variabilidade_eMenor_uxi = desvpada(leituras_eMenor);
    var variabilidade_eMenor_div = Math.sqrt(4);
    var variabilidade_eMenor_coef = variabilidade_eMaior_coef;
    var variabilidade_eMenor_ciUxi = variabilidade_eMenor_uxi * variabilidade_eMenor_coef/variabilidade_eMenor_div;
    var variabilidade_eMenor_uiY2 = variabilidade_eMenor_ciUxi^2;
    
    // resolução E (menor)
    var resolucao_eMenor_uxi = resolucao_eMaior_uxi;
    var resolucao_eMenor_div = Math.sqrt(3);
    var resolucao_eMenor_coef = variabilidade_eMaior_coef;
    var resolucao_eMenor_ciUxi = resolucao_eMenor_uxi * resolucao_eMenor_coef/resolucao_eMenor_div;
    var resolucao_eMenor_uiY2 = resolucao_eMenor_ciUxi^2;


    // Cert pH (maior)
    var cert_phMaior_uxi = uPhMaior;
    var cert_phMaior_div = calculo_c11_kPhMaior;
    var cert_phMaior_coef = Math.abs((eMaior-eMenor)/(phMaior-phMenor)^2);
    var cert_phMaior_ciUxi = cert_phMaior_uxi * cert_phMaior_coef/cert_phMaior_div;
    var cert_phMaior_uiY2 = cert_phMaior_ciUxi^2;

    // Cert pH (menor)
    var cert_phMenor_uxi = uPhMenor;
    var cert_phMenor_div = calculo_c15_kPhMenor;
    var cert_phMenor_coef = cert_phMaior_coef;
    var cert_phMenor_ciUxi = cert_phMenor_uxi * cert_phMenor_coef/cert_phMenor_div;
    var cert_phMenor_uiY2 = cert_phMenor_ciUxi^2;

    // variabilidade Temp
    var variabilidade_temp_uxi = document.getElementById('configuracoes_e7').value;
    var variabilidade_temp_div = Math.sqrt(3);
    var variabilidade_temp_coef = calculo_c5_R * Math.log(10) * 1000/calculo_c6_F;
    var variabilidade_temp_ciUxi = variabilidade_temp_uxi * variabilidade_temp_coef/variabilidade_temp_div;
    var variabilidade_temp_uiY2 = variabilidade_temp_ciUxi^2;

    // Cert. Temp
    var cert_temp_uxi = document.getElementById('configuracoes_e6').value;
    var cert_temp_div = 2;
    var cert_temp_coef = variabilidade_temp_coef;
    var cert_temp_ciUxi = cert_temp_uxi * cert_temp_coef/cert_temp_div;
    var cert_temp_uiY2 = cert_temp_ciUxi^2;


    // Junção de referência
    var juncaoDeReferencia_uxi = document.getElementById('configuracoes_e9').value;
    var juncaoDeReferencia_div = Math.sqrt(3);
    var juncaoDeReferencia_coef = variabilidade_eMaior_coef;
    var juncaoDeReferencia_ciUxi = juncaoDeReferencia_uxi * juncaoDeReferencia_coef/juncaoDeReferencia_div;
    var juncaoDeReferencia_uiY2 = juncaoDeReferencia_ciUxi^2;


    // incerteza calculada
    var ukLinha_total = 
            variabilidade_eMaior_uiY2 +
            resolucao_eMaior_uiY2 +
            variabilidade_eMenor_uiY2 +
            resolucao_eMenor_uiY2 +
            cert_phMaior_uiY2 +
            cert_phMenor_uiY2 +
            variabilidade_temp_uiY2 +
            cert_temp_uiY2 +
            juncaoDeReferencia_uiY2;
    
    var ukLinha_variabilidade_eMaior_contrib = variabilidade_eMaior_uiY2 / ukLinha_total * 100
    var ukLinha_resolucao_eMaior_contrib = resolucao_eMaior_uiY2 / ukLinha_total * 100
    var ukLinha_variabilidade_eMenor_contrib = variabilidade_eMenor_uiY2 / ukLinha_total * 100
    var ukLinha_resolucao_eMenor_contrib = resolucao_eMenor_uiY2 / ukLinha_total * 100
    var ukLinha_cert_phMaior_contrib = cert_phMaior_uiY2 / ukLinha_total * 100
    var ukLinha_cert_phMenor_contrib = cert_phMenor_uiY2 / ukLinha_total * 100
    var ukLinha_variabilidade_temp_contrib = variabilidade_temp_uiY2 / ukLinha_total * 100
    var ukLinha_cert_temp_contrib = cert_temp_uiY2 / ukLinha_total * 100
    var ukLinha_juncaoDeReferencia_contrib = juncaoDeReferencia_uiY2 / ukLinha_total * 100
    
    var ukLinha_uc = Math.sqrt(ukLinha_total);
    
    var ukLinha_veff = ukLinha_uc^4/
        (
            (variabilidade_eMaior_ciUxi^4)/3 + 
            (variabilidade_eMenor_ciUxi^4)/3 + 
            (variabilidade_temp_ciUxi^4)/3
        );
    
    var ukLinha_k = 0;
    if ( (ukLinha_veff > 60) || (variabilidade_eMaior_ciUxi == 0 && variabilidade_eMenor_ciUxi == 0))
    {ukLinha_k = 2;}
    else {ukLinha_k = 3;}
    //else {ukLinha_k = invt(0.05, ukLinha_veff);}

    var ukLinha_u = ukLinha_k * ukLinha_uc;


    ////////////////////////////////////////////////////////////////
    // Incerteza pH(X)

    // Cert pH (maior)
    var cert_phMaior_uxi = uPhMaior;
    var cert_phMaior_div = calculo_c11_kPhMaior;
    var cert_phMaior_coef = 1;
    var cert_phMaior_ciUxi = cert_phMaior_uxi * cert_phMaior_coef/cert_phMaior_div;
    var cert_phMaior_uiY2 = cert_phMaior_ciUxi^2;
    
    // variabilidade E (maior)
    var variabilidade_eMaior_uxi = variabilidade_eMaior_uxi;
    var variabilidade_eMaior_div = Math.sqrt(4);
    var variabilidade_eMaior_coef = Math.abs(1/kLinha);
    var variabilidade_eMaior_ciUxi = variabilidade_eMaior_uxi * variabilidade_eMaior_coef/variabilidade_eMaior_div;
    var variabilidade_eMaior_uiY2 = variabilidade_eMaior_ciUxi^2;
    
    // resolução E (maior)
    var resolucao_eMaior_uxi = resolucao_eMaior_uxi;
    var resolucao_eMaior_div = Math.sqrt(3);
    var resolucao_eMaior_coef = variabilidade_eMaior_coef;
    var resolucao_eMaior_ciUxi = resolucao_eMaior_uxi * resolucao_eMaior_coef/resolucao_eMaior_div;
    var resolucao_eMaior_uiY2 = resolucao_eMaior_ciUxi^2;

    // variabilidade E(x)
    var leituras_eX = [
        document.getElementById('metodo2pontos_i22').value,
        document.getElementById('metodo2pontos_i23').value,
        document.getElementById('metodo2pontos_i24').value
    ];
    var variabilidade_eX_uxi = desvpada(leituras_eX);
    var variabilidade_eX_div = Math.sqrt(4);
    var variabilidade_eX_coef = variabilidade_eMaior_coef;
    var variabilidade_eX_ciUxi = variabilidade_eX_uxi * variabilidade_eX_coef/variabilidade_eX_div;
    var variabilidade_eX_uiY2 = variabilidade_eX_ciUxi^2;

    // resolução E(x)
    var resolucao_eX_uxi = resolucao_eMaior_uxi;
    var resolucao_eX_div = Math.sqrt(3);
    var resolucao_eX_coef = variabilidade_eMaior_coef;
    var resolucao_eX_ciUxi = resolucao_eX_uxi * resolucao_eX_coef/resolucao_eX_div;
    var resolucao_eX_uiY2 = resolucao_eX_ciUxi^2;

    // incerteza k'
    var incerteza_kLinha_uxi = ukLinha_u;
    var incerteza_kLinha_div = ukLinha_k;
    var incerteza_kLinha_coef = Math.abs((eX-eMaior)/(kLinha)^2);
    var incerteza_kLinha_ciUxi = incerteza_kLinha_uxi * incerteza_kLinha_coef/incerteza_kLinha_div;
    var incerteza_kLinha_uiY2 = incerteza_kLinha_ciUxi^2;
    
    // Não-linearidade (parte elétrica)
    var naoLinearidadeParteEletrica_uxi = document.getElementById('configuracoes_e8').value * eX / 100;
    var naoLinearidadeParteEletrica_div = Math.sqrt(3);
    var naoLinearidadeParteEletrica_coef = variabilidade_eMaior_coef;
    var naoLinearidadeParteEletrica_ciUxi = naoLinearidadeParteEletrica_uxi * naoLinearidadeParteEletrica_coef/naoLinearidadeParteEletrica_div
    var naoLinearidadeParteEletrica_uiY2 = naoLinearidadeParteEletrica_ciUxi^2;

    // incerteza calculada
    var uphx_total =
        cert_phMaior_uiY2 +
        variabilidade_eMaior_uiY2 +
        resolucao_eMaior_uiY2 +
        variabilidade_eX_uiY2 +
        resolucao_eX_uiY2 +
        incerteza_kLinha_uiY2 +
        naoLinearidadeParteEletrica_uiY2;

    var uphx_cert_phMaior_contrib = cert_phMaior_uiY2 / uphx_total * 100
    var uphx_variabilidade_eMaior_contrib = variabilidade_eMaior_uiY2 / uphx_total * 100
    var uphx_resolucao_eMaior_contrib = resolucao_eMaior_uiY2 / uphx_total * 100
    var uphx_variabilidade_eX_contrib = variabilidade_eX_uiY2 / uphx_total * 100
    var uphx_incerteza_kLinha_contrib = incerteza_kLinha_uiY2 / uphx_total * 100
    var uphx_naoLinearidadeParteEletrica_contrib = naoLinearidadeParteEletrica_uiY2 / uphx_total * 100

    var uphx_uc = Math.sqrt(uphx_total);
    
    var uphx_veff = 0;
    if (variabilidade_eMaior_uxi == 0 && variabilidade_eX_uxi == 0)
    {uphx_veff = 1000;}
    else{
        uphx_veff =  uphx_uc^4/
        (
            (variabilidade_eMaior_ciUxi^4/3) +
            (variabilidade_eX_ciUxi^4/3)
        );
    }

    var uphx_k = 0;
    if ( (uphx_veff > 60) || (variabilidade_eMaior_ciUxi == 0 && variabilidade_eX_ciUxi == 0))
    {uphx_k = 2;}
    else {uphx_k = 3;}
    //else {uphx_k = invt(0.05, uphx_veff);}
    
    var uphx_u = uphx_k * uphx_uc;

    // return ukLinha_k, ukLinha_u, uphx_k, uphx_u;
    // document.getElementById('a3').value = parseInt(resources)*parseInt(minutes); 
    document.getElementById('resp_1').value = ukLinha_k; 
    document.getElementById('resp_2').value = ukLinha_u; 
    document.getElementById('resp_3').value = uphx_k; 
    document.getElementById('resp_4').value = uphx_u; 

   }
</script>

<!-- //////////////////////////////////////////////////////////////// -->
<div>Método dois pontos</div>
<div>&nbsp</div>

<div>MRC pH (maior) <input id="metodo2pontos_i8" type="text" value="6.859"/></div>
<div>U pH (maior) <input id="metodo2pontos_i9" type="text" value="0.023"/></div>
<div>&nbsp</div>

<div>MRC pH (menor) <input id="metodo2pontos_i11" type="text" value="4.007" /></div>
<div>U pH (menor) <input id="metodo2pontos_i12" type="text" value="0.026"/></div>
<div>&nbsp</div>

<div>Leitura 1 pH (maior) em mV <input id="metodo2pontos_i14" type="text" value="-15.1" /></div>
<div>Leitura 2 pH (maior) em mV <input id="metodo2pontos_i15" type="text" value="-15.1"/></div>
<div>Leitura 3 pH (maior) em mV <input id="metodo2pontos_i16" type="text" value="-15.1"/></div>
<div>&nbsp</div>

<div>Leitura 1 pH (menor) em mV <input id="metodo2pontos_i18" type="text" value="153.8"/></div>
<div>Leitura 2 pH (menor) em mV <input id="metodo2pontos_i19" type="text" value="153.8"/></div>
<div>Leitura 3 pH (menor) em mV <input id="metodo2pontos_i20" type="text" value="153.8"/></div>
<div>&nbsp</div>

<div>Leitura 1 pH (X) em mV <input id="metodo2pontos_i22" type="text" value="153.8"/></div>
<div>Leitura 2 pH (X) em mV <input id="metodo2pontos_i23" type="text" value="153.7"/></div>
<div>Leitura 3 pH (X) em mV <input id="metodo2pontos_i24" type="text" value="153.6"/></div>
<div>&nbsp</div>

<div> <input type ="button" onsubmit="m2p()" onclick="m2p()" /> </div>

<div>k k' <input id="resp_1" type="text" /></div>
<div>U k' <input id="resp_2" type="text" /></div>
<div>k pH (X) <input id="resp_3" type="text" /></div>
<div>U pH (X) <input id="resp_4" type="text" /></div>
<div>&nbsp</div>


<div>&nbsp</div>
<hr>
<div>&nbsp</div>

<!-- //////////////////////////////////////////////////////////////// -->
<div>Configurações</div>
<div>&nbsp</div>

<div>Resolução em tensão <input id="configuracoes_e5" type="text" /> mV</div>
<div>Incerteza do termômetro <input id="configuracoes_e6" type="text" /> °C</div>
<div>Variabilidade da temperatura <input id="configuracoes_e7" type="text" /> °C</div>
<div>Não-linearidade da faixa <input id="configuracoes_e8" type="text" /> %</div>
<div>Junção de referência <input id="configuracoes_e9" type="text" /> mV</div>

<div>&nbsp</div>
<hr>
<div>&nbsp</div>


<!-- //////////////////////////////////////////////////////////////// -->
<!-- Cálculo -->







<div>MRC pH (maior) <input id="i" type="text" /></div>
<div>MRC pH (maior) <input id="i" type="text" /></div>
<input id="a2" type="text" onblur="calculate()"  />
<input id="a3" type="text" name="total_amt" />
